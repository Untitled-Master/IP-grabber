<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Location and Device Information</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <style>
        #map {
            height: 300px;
            width: 100%;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>User Information</h1>
    <p id="ip-address">IP Address: Loading...</p>
    <p id="device-info">Device: Loading...</p>
    <p id="os">Operating System: Loading...</p>
    <p id="browser">Browser: Loading...</p>
    <p id="user-agent">User-Agent: Loading...</p>
    <p id="language">Language: Loading...</p>
    <p id="location">Location: Loading...</p>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script>
        // Function to get the IP address
        async function getIpAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                document.getElementById('ip-address').textContent = `IP Address: ${data.ip}`;
            } catch (error) {
                console.error('Error fetching IP address:', error);
                document.getElementById('ip-address').textContent = 'IP Address: Unable to retrieve';
            }
        }

        // Function to get the device information
        function getDeviceInfo() {
            const userAgent = navigator.userAgent;
            const platform = navigator.platform;
            const language = navigator.language;
            let deviceType = "Unknown Device";
            let os = "Unknown OS";
            let browser = "Unknown Browser";

            // Determine the device type
            if (/Mobi|Android/i.test(userAgent)) {
                deviceType = "Mobile";
            } else if (/Tablet|iPad/i.test(userAgent)) {
                deviceType = "Tablet";
            } else {
                deviceType = "Desktop/Laptop";
            }

            // Determine the operating system
            if (/Windows NT/.test(userAgent)) {
                os = "Windows";
            } else if (/Mac OS X/.test(userAgent)) {
                os = "Mac OS";
            } else if (/Linux/.test(userAgent)) {
                os = "Linux";
            } else if (/Android/.test(userAgent)) {
                os = "Android";
            } else if (/iOS|iPhone|iPad|iPod/.test(userAgent)) {
                os = "iOS";
            }

            // Determine the browser
            if (/Chrome/.test(userAgent)) {
                browser = "Google Chrome";
            } else if (/Safari/.test(userAgent) && !/Chrome/.test(userAgent)) {
                browser = "Safari";
            } else if (/Firefox/.test(userAgent)) {
                browser = "Mozilla Firefox";
            } else if (/Edge/.test(userAgent)) {
                browser = "Microsoft Edge";
            } else if (/MSIE|Trident/.test(userAgent)) {
                browser = "Internet Explorer";
            }

            // Set the data to the HTML elements
            document.getElementById('device-info').textContent = `Device: ${deviceType}`;
            document.getElementById('os').textContent = `Operating System: ${os}`;
            document.getElementById('browser').textContent = `Browser: ${browser}`;
            document.getElementById('user-agent').textContent = `User-Agent: ${userAgent}`;
            document.getElementById('language').textContent = `Language: ${language}`;
        }

        // Function to get the user's location and display it on the map
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        document.getElementById('location').textContent = `Location: Latitude ${latitude}, Longitude ${longitude}`;

                        // Initialize the map
                        const map = L.map('map').setView([latitude, longitude], 13);

                        // Add OpenStreetMap tiles
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                        }).addTo(map);

                        // Add a marker at the user's location
                        L.marker([latitude, longitude]).addTo(map)
                            .bindPopup('You are here!')
                            .openPopup();
                    },
                    (error) => {
                        console.error('Error retrieving location:', error);
                        document.getElementById('location').textContent = 'Location: Unable to retrieve';
                    }
                );
            } else {
                document.getElementById('location').textContent = 'Location: Geolocation is not supported by this browser.';
            }
        }

        // Call the functions when the page loads
        getIpAddress();
        getDeviceInfo();
        getLocation();
    </script>
</body>
</html>
